
R Under development (unstable) (2026-01-07 r89288) -- "Unsuffered Consequences"
Copyright (C) 2026 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> pkgname <- "epiworldR"
> source(file.path(R.home("share"), "R", "examples-header.R"))
> options(warn = 1)
> library('epiworldR')
Thank you for using epiworldR! Please consider citing it in your work.
You can find the citation information by running
  citation("epiworldR")
> 
> base::assign(".oldSearch", base::search(), pos = 'CheckExEnv')
> base::assign(".old_wd", base::getwd(), pos = 'CheckExEnv')
> cleanEx()
> nameEx("LFMCMC")
> ### * LFMCMC
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: LFMCMC
> ### Title: Likelihood-Free Markhov Chain Monte Carlo (LFMCMC)
> ### Aliases: LFMCMC epiworld_lfmcmc run_lfmcmc set_observed_data
> ###   set_proposal_fun use_proposal_norm_reflective set_simulation_fun
> ###   set_summary_fun set_kernel_fun use_kernel_fun_gaussian
> ###   get_mean_params get_mean_stats get_initial_params
> ###   get_current_proposed_params get_current_accepted_params
> ###   get_current_proposed_stats get_current_accepted_stats
> ###   get_observed_stats get_all_sample_params get_all_sample_stats
> ###   get_all_sample_acceptance get_all_sample_drawn_prob
> ###   get_all_sample_kernel_scores get_all_accepted_params
> ###   get_all_accepted_stats get_all_accepted_kernel_scores get_n_samples
> ###   get_n_stats get_n_params verbose_off.epiworld_lfmcmc set_params_names
> ###   set_stats_names print.epiworld_lfmcmc
> 
> ### ** Examples
> 
> ## Setup an SIR model to use in the simulation
> model_seed <- 122
> model_sir <- ModelSIR(name = "COVID-19", prevalence = .1,
+   transmission_rate = .9, recovery_rate = .3)
> agents_smallworld(
+   model_sir,
+   n = 1000,
+   k = 5,
+   d = FALSE,
+   p = 0.01
+ )
> verbose_off(model_sir)
> run(model_sir, ndays = 50, seed = model_seed)
> 
> ## Setup LFMCMC
> # Extract the observed data from the model
> obs_data <- get_today_total(model_sir)
> 
> # Define the simulation function
> simfun <- function(params, lfmcmc_obj) {
+   set_param(model_sir, "Recovery rate", params[1])
+   set_param(model_sir, "Transmission rate", params[2])
+   run(model_sir, ndays = 50)
+   res <- get_today_total(model_sir)
+   return(res)
+ }
> 
> # Define the summary function
> sumfun <- function(dat, lfmcmc_obj) {
+   return(dat)
+ }
> 
> # Create the LFMCMC model
> lfmcmc_model <- LFMCMC(model_sir) |>
+   set_simulation_fun(simfun) |>
+   set_summary_fun(sumfun) |>
+   use_proposal_norm_reflective() |>
+   use_kernel_fun_gaussian() |>
+   set_observed_data(obs_data)
> 
> ## Run LFMCMC simulation
> # Set initial parameters
> par0 <- c(0.1, 0.5)
> n_samp <- 2000
> epsil <- 1.0
> 
> # Run the LFMCMC simulation
> verbose_off(lfmcmc_model)
> run_lfmcmc(
+   lfmcmc = lfmcmc_model,
+   params_init = par0,
+   n_samples = n_samp,
+   epsilon = epsil,
+   seed = model_seed
+ )
> 
> # Print the results
> set_stats_names(lfmcmc_model, get_states(model_sir))
> set_params_names(lfmcmc_model, c("Immune recovery", "Infectiousness"))
> 
> print(lfmcmc_model)
___________________________________________

LIKELIHOOD-FREE MARKOV CHAIN MONTE CARLO

N Samples (total) : 2000
N Samples (after burn-in period) : 2000
Elapsed t : 3.00s

Parameters:
  -Immune recovery :  0.47 [ 0.13,  0.95] (initial :  0.10)
  -Infectiousness  :  0.84 [ 0.50,  0.99] (initial :  0.50)

Statistics:
  -Susceptible :     0.25 [    0.00,     2.00] (Observed:     0.00)
  -Infected    :     0.05 [    0.00,     1.00] (Observed:     0.00)
  -Recovered   :   998.71 [  998.00,  1000.00] (Observed:  1000.00)
___________________________________________

> 
> get_mean_stats(lfmcmc_model)
[1]   0.248   0.046 998.706
> get_mean_params(lfmcmc_model)
[1] 0.4668447 0.8356060
> 
> 
> 
> 
> cleanEx()
> nameEx("ModelDiffNet")
> ### * ModelDiffNet
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelDiffNet
> ### Title: Network Diffusion Model
> ### Aliases: ModelDiffNet epiworld_diffnet
> 
> ### ** Examples
> 
> set.seed(2223)
> n <- 10000
> 
> # Generating synthetic data on a matrix with 2 columns.
> X <- cbind(
+   age = sample(1:100, n, replace = TRUE),
+   female = sample.int(2, n, replace = TRUE) - 1
+ )
> 
> adopt_chatgpt <- ModelDiffNet(
+   "ChatGPT",
+   prevalence = .01,
+   prob_adopt = .1,
+   data       = X,
+   params     = c(1, 4)
+ )
> 
> # Simulating a population from smallworld
> agents_smallworld(adopt_chatgpt, n, 8, FALSE, .01)
> 
> # Running the model for 50 steps
> run(adopt_chatgpt, 50)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> 
> # Plotting the model
> plot(adopt_chatgpt)
> 
> 
> 
> cleanEx()
> nameEx("ModelSEIR")
> ### * ModelSEIR
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSEIR
> ### Title: Susceptible Exposed Infected Recovered model (SEIR)
> ### Aliases: ModelSEIR epiworld_seir
> 
> ### ** Examples
> 
> model_seir <- ModelSEIR(name = "COVID-19", prevalence = 0.01,
+   transmission_rate = 0.9, recovery_rate = 0.1, incubation_days = 4)
> 
> # Adding a small world population
> agents_smallworld(
+   model_seir,
+   n = 1000,
+   k = 5,
+   d = FALSE,
+   p = .01
+ )
> 
> # Running and printing
> run(model_seir, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_seir
________________________________________________________________________________
Susceptible-Exposed-Infected-Removed (SEIR)
It features 1000 agents, 1 virus(es), and 0 tool(s).
The model has 4 states.
The final distribution is: 0 Susceptible, 0 Exposed, 0 Infected, and 1000 Removed.
> 
> plot(model_seir, main = "SEIR Model")
> 
> 
> 
> cleanEx()
> nameEx("ModelSEIRCONN")
> ### * ModelSEIRCONN
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSEIRCONN
> ### Title: Susceptible Exposed Infected Removed model (SEIR connected)
> ### Aliases: ModelSEIRCONN epiworld_seirconn
> 
> ### ** Examples
> 
> # An example with COVID-19
> model_seirconn <- ModelSEIRCONN(
+   name                = "COVID-19",
+   prevalence          = 0.01,
+   n                   = 10000,
+   contact_rate        = 2,
+   incubation_days     = 7,
+   transmission_rate   = 0.5,
+   recovery_rate       = 0.3
+ )
> 
> # Running and printing
> run(model_seirconn, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_seirconn
________________________________________________________________________________
Susceptible-Exposed-Infected-Removed (SEIR) (connected)
It features 10000 agents, 1 virus(es), and 0 tool(s).
The model has 4 states.
The final distribution is: 446 Susceptible, 4 Exposed, 3 Infected, and 9547 Recovered.
> 
> plot(model_seirconn)
> 
> # Adding the flu
> flu <- virus("Flu", .9, 1 / 7, prevalence = 0.001, as_proportion = TRUE)
> add_virus(model_seirconn, flu)
> 
> #' # Running and printing
> run(model_seirconn, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_seirconn
________________________________________________________________________________
Susceptible-Exposed-Infected-Removed (SEIR) (connected)
It features 10000 agents, 2 virus(es), and 0 tool(s).
The model has 4 states.
The final distribution is: 0 Susceptible, 0 Exposed, 0 Infected, and 10000 Recovered.
> 
> plot(model_seirconn)
> 
> 
> 
> cleanEx()
> nameEx("ModelSEIRD")
> ### * ModelSEIRD
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSEIRD
> ### Title: Susceptible-Exposed-Infected-Recovered-Deceased model (SEIRD)
> ### Aliases: ModelSEIRD epiworld_seird
> 
> ### ** Examples
> 
> model_seird <- ModelSEIRD(name = "COVID-19", prevalence = 0.01,
+   transmission_rate = 0.9, recovery_rate = 0.1, incubation_days = 4,
+   death_rate = 0.01)
> 
> # Adding a small world population
> agents_smallworld(
+   model_seird,
+   n = 100000,
+   k = 5,
+   d = FALSE,
+   p = .01
+ )
> 
> # Running and printing
> run(model_seird, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_seird
________________________________________________________________________________
Susceptible-Exposed-Infected-Removed-Deceased (SEIRD)
It features 100000 agents, 1 virus(es), and 0 tool(s).
The model has 5 states.
The final distribution is: 10 Susceptible, 20 Exposed, 80 Infected, 91512 Removed, and 8378 Deceased.
> 
> plot(model_seird, main = "SEIRD Model")
> 
> 
> 
> cleanEx()
> nameEx("ModelSEIRDCONN")
> ### * ModelSEIRDCONN
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSEIRDCONN
> ### Title: Susceptible Exposed Infected Removed Deceased model (SEIRD
> ###   connected)
> ### Aliases: ModelSEIRDCONN epiworld_seirdconn
> 
> ### ** Examples
> 
> # An example with COVID-19
> model_seirdconn <- ModelSEIRDCONN(
+   name                = "COVID-19",
+   prevalence          = 0.01,
+   n                   = 10000,
+   contact_rate        = 2,
+   incubation_days     = 7,
+   transmission_rate   = 0.5,
+   recovery_rate       = 0.3,
+   death_rate          = 0.01
+ )
> 
> # Running and printing
> run(model_seirdconn, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_seirdconn
________________________________________________________________________________
Susceptible-Exposed-Infected-Removed-Deceased (SEIRD) (connected)
It features 10000 agents, 1 virus(es), and 0 tool(s).
The model has 5 states.
The final distribution is: 490 Susceptible, 2 Exposed, 1 Infected, 9280 Removed, and 227 Deceased.
> 
> plot(model_seirdconn)
> 
> # Adding the flu
> flu <- virus(
+   "Flu", prob_infecting = .3, recovery_rate = 1 / 7,
+   prob_death = 0.001,
+   prevalence = 0.001, as_proportion = TRUE
+ )
> add_virus(model = model_seirdconn, virus = flu)
> 
> #' # Running and printing
> run(model_seirdconn, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_seirdconn
________________________________________________________________________________
Susceptible-Exposed-Infected-Removed-Deceased (SEIRD) (connected)
It features 10000 agents, 2 virus(es), and 0 tool(s).
The model has 5 states.
The final distribution is: 449 Susceptible, 8 Exposed, 8 Infected, 9331 Removed, and 204 Deceased.
> 
> plot(model_seirdconn)
> 
> 
> 
> cleanEx()
> nameEx("ModelSEIRMixing")
> ### * ModelSEIRMixing
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSEIRMixing
> ### Title: Susceptible Exposed Infected Removed model (SEIR) with mixing
> ### Aliases: ModelSEIRMixing epiworld_seirmixing
> 
> ### ** Examples
> 
> 
> # Start off creating three entities.
> # Individuals will be distribured randomly between the three.
> e1 <- entity("Population 1", 3e3, as_proportion = FALSE)
> e2 <- entity("Population 2", 3e3, as_proportion = FALSE)
> e3 <- entity("Population 3", 3e3, as_proportion = FALSE)
> 
> # Row-stochastic matrix (rowsums 1)
> cmatrix <- c(
+   c(0.9, 0.05, 0.05),
+   c(0.1, 0.8, 0.1),
+   c(0.1, 0.2, 0.7)
+ ) |> matrix(byrow = TRUE, nrow = 3)
> 
> N <- 9e3
> 
> flu_model <- ModelSEIRMixing(
+   name              = "Flu",
+   n                 = N,
+   prevalence        = 1 / N,
+   contact_rate      = 20,
+   transmission_rate = 0.1,
+   recovery_rate     = 1 / 7,
+   incubation_days   = 7,
+   contact_matrix    = cmatrix
+ )
> 
> # Adding the entities to the model
> flu_model |>
+   add_entity(e1) |>
+   add_entity(e2) |>
+   add_entity(e3)
> 
> set.seed(331)
> run(flu_model, ndays = 100)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> summary(flu_model)
________________________________________________________________________________
________________________________________________________________________________
SIMULATION STUDY

Name of the model   : Susceptible-Exposed-Infected-Removed (SEIR) with Mixing
Population size     : 9000
Agents' data        : (none)
Number of entities  : 3
Days (duration)     : 100 (of 100)
Number of viruses   : 1
Last run elapsed t  : 161.00ms
Last run speed      : 5.59 million agents x day / second
Rewiring            : off

Global events:
 - Update infected individuals (runs daily)

Virus(es):
 - Flu

Tool(s):
 (none)

Model parameters:
 - Avg. Incubation days : 7.0000
 - Contact rate         : 20.0000
 - Prob. Recovery       : 0.1429
 - Prob. Transmission   : 0.1000

Distribution of the population at time 100:
  - (0) Susceptible : 8999 -> 0
  - (1) Exposed     :    1 -> 0
  - (2) Infected    :    0 -> 0
  - (3) Recovered   :    0 -> 9000

Transition Probabilities:
 - Susceptible  0.96  0.04     -     -
 - Exposed         -  0.86  0.14     -
 - Infected        -     -  0.86  0.14
 - Recovered       -     -     -  1.00

> plot_incidence(flu_model)
> 
> 
> 
> 
> cleanEx()
> nameEx("ModelSEIRMixingQuarantine")
> ### * ModelSEIRMixingQuarantine
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSEIRMixingQuarantine
> ### Title: Susceptible Exposed Infected Removed model (SEIR) with mixing
> ###   and quarantine
> ### Aliases: ModelSEIRMixingQuarantine epiworld_seirmixingquarantine
> 
> ### ** Examples
> 
> 
> # Start off creating three entities.
> # Individuals will be distributed randomly between the three.
> e1 <- entity("Population 1", 3e3, as_proportion = FALSE)
> e2 <- entity("Population 2", 3e3, as_proportion = FALSE)
> e3 <- entity("Population 3", 3e3, as_proportion = FALSE)
> 
> # Row-stochastic matrix (rowsums 1)
> cmatrix <- c(
+   c(0.9, 0.05, 0.05),
+   c(0.1, 0.8, 0.1),
+   c(0.1, 0.2, 0.7)
+ ) |> matrix(byrow = TRUE, nrow = 3)
> 
> N <- 9e3
> 
> flu_model <- ModelSEIRMixingQuarantine(
+   name                  = "Flu",
+   n                     = N,
+   prevalence            = 1 / N,
+   contact_rate          = 20,
+   transmission_rate     = 0.1,
+   recovery_rate         = 1 / 7,
+   incubation_days       = 7,
+   contact_matrix        = cmatrix,
+   hospitalization_rate  = 0.05,
+   hospitalization_period = 7,
+   days_undetected       = 3,
+   quarantine_period     = 14,
+   quarantine_willingness = 0.8,
+   isolation_period      = 7,
+   isolation_willingness = 0.5,
+   contact_tracing_success_rate = 0.7,
+   contact_tracing_days_prior = 3
+ )
> 
> # Adding the entities to the model
> flu_model |>
+   add_entity(e1) |>
+   add_entity(e2) |>
+   add_entity(e3)
> 
> set.seed(331)
> run(flu_model, ndays = 100)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> summary(flu_model)
________________________________________________________________________________
________________________________________________________________________________
SIMULATION STUDY

Name of the model   : SEIR with Mixing and Quarantine
Population size     : 9000
Agents' data        : (none)
Number of entities  : 3
Days (duration)     : 100 (of 100)
Number of viruses   : 1
Last run elapsed t  : 67.00ms
Last run speed      : 13.25 million agents x day / second
Rewiring            : off

Global events:
 - Update infected individuals (runs daily)

Virus(es):
 - Flu

Tool(s):
 (none)

Model parameters:
 - Avg. Incubation days         : 7.0000
 - Contact rate                 : 20.0000
 - Contact tracing days prior   : 3.0000
 - Contact tracing success rate : 0.7000
 - Days undetected              : 3.0000
 - Hospitalization period       : 7.0000
 - Hospitalization rate         : 0.0500
 - Isolation period             : 7.0000
 - Isolation willingness        : 0.5000
 - Prob. Recovery               : 0.1429
 - Prob. Transmission           : 0.1000
 - Quarantine period            : 14.0000
 - Quarantine willingness       : 0.8000

Distribution of the population at time 100:
  - ( 0) Susceptible             : 8999 -> 8998
  - ( 1) Exposed                 :    1 -> 0
  - ( 2) Infected                :    0 -> 0
  - ( 3) Isolated                :    0 -> 0
  - ( 4) Detected Hospitalized   :    0 -> 0
  - ( 5) Quarantined Susceptible :    0 -> 0
  - ( 6) Quarantined Exposed     :    0 -> 0
  - ( 7) Isolated Recovered      :    0 -> 0
  - ( 8) Hospitalized            :    0 -> 0
  - ( 9) Recovered               :    0 -> 2

Transition Probabilities:
 - Susceptible              1.00  0.00     -     -     -  0.00     -     -     -     -
 - Exposed                     -  0.82  0.18     -     -     -     -     -     -     -
 - Infected                    -     -     -  0.50     -     -     -     -     -  0.50
 - Isolated                    -     -     -  0.67     -     -     -  0.33     -     -
 - Detected Hospitalized       -     -     -     -     -     -     -     -     -     -
 - Quarantined Susceptible  0.07     -     -     -     -  0.93     -     -     -     -
 - Quarantined Exposed         -     -     -     -     -     -     -     -     -     -
 - Isolated Recovered          -     -     -     -     -     -     -  0.67     -  0.33
 - Hospitalized                -     -     -     -     -     -     -     -     -     -
 - Recovered                   -     -     -     -     -     -     -     -     -  1.00

> 
> 
> 
> 
> cleanEx()
> nameEx("ModelSIR")
> ### * ModelSIR
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSIR
> ### Title: SIR model
> ### Aliases: ModelSIR epiworld_sir
> 
> ### ** Examples
> 
> model_sir <- ModelSIR(name = "COVID-19", prevalence = 0.01,
+   transmission_rate = 0.9, recovery_rate = 0.1)
> 
> # Adding a small world population
> agents_smallworld(
+   model_sir,
+   n = 1000,
+   k = 5,
+   d = FALSE,
+   p = .01
+ )
> 
> # Running and printing
> run(model_sir, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_sir
________________________________________________________________________________
Susceptible-Infected-Recovered (SIR)
It features 1000 agents, 1 virus(es), and 0 tool(s).
The model has 3 states.
The final distribution is: 0 Susceptible, 0 Infected, and 1000 Recovered.
> 
> # Plotting
> plot(model_sir)
> 
> 
> 
> cleanEx()
> nameEx("ModelSIRCONN")
> ### * ModelSIRCONN
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSIRCONN
> ### Title: Susceptible Infected Removed model (SIR connected)
> ### Aliases: ModelSIRCONN epiworld_sirconn
> 
> ### ** Examples
> 
> model_sirconn <- ModelSIRCONN(
+   name                = "COVID-19",
+   n                   = 10000,
+   prevalence          = 0.01,
+   contact_rate        = 5,
+   transmission_rate   = 0.4,
+   recovery_rate       = 0.95
+ )
> 
> # Running and printing
> run(model_sirconn, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_sirconn
________________________________________________________________________________
Susceptible-Infected-Removed (SIR) (connected)
It features 10000 agents, 1 virus(es), and 0 tool(s).
The model has 3 states.
The final distribution is: 2012 Susceptible, 0 Infected, and 7988 Recovered.
> 
> plot(model_sirconn,  main = "SIRCONN Model")
> 
> 
> 
> cleanEx()
> nameEx("ModelSIRD")
> ### * ModelSIRD
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSIRD
> ### Title: SIRD model
> ### Aliases: ModelSIRD epiworld_sird
> 
> ### ** Examples
> 
> model_sird <- ModelSIRD(
+   name              = "COVID-19",
+   prevalence        = 0.01,
+   transmission_rate = 0.9,
+   recovery_rate     = 0.1,
+   death_rate        = 0.01
+ )
> 
> # Adding a small world population
> agents_smallworld(
+   model_sird,
+   n = 1000,
+   k = 5,
+   d = FALSE,
+   p = .01
+ )
> 
> # Running and printing
> run(model_sird, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_sird
________________________________________________________________________________
Susceptible-Infected-Recovered-Deceased (SIRD)
It features 1000 agents, 1 virus(es), and 0 tool(s).
The model has 4 states.
The final distribution is: 0 Susceptible, 0 Infected, 912 Recovered, and 88 Deceased.
> 
> # Plotting
> plot(model_sird)
> 
> 
> 
> cleanEx()
> nameEx("ModelSIRDCONN")
> ### * ModelSIRDCONN
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSIRDCONN
> ### Title: Susceptible Infected Removed Deceased model (SIRD connected)
> ### Aliases: ModelSIRDCONN epiworld_sirdconn
> 
> ### ** Examples
> 
> model_sirdconn <- ModelSIRDCONN(
+   name                = "COVID-19",
+   n                   = 100000,
+   prevalence          = 0.01,
+   contact_rate        = 5,
+   transmission_rate   = 0.4,
+   recovery_rate       = 0.5,
+   death_rate          = 0.1
+ )
> 
> # Running and printing
> run(model_sirdconn, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_sirdconn
________________________________________________________________________________
Susceptible-Infected-Removed-Deceased (SIRD) (connected)
It features 100000 agents, 1 virus(es), and 0 tool(s).
The model has 4 states.
The final distribution is: 3678 Susceptible, 0 Infected, 86905 Recovered, and 9417 Deceased.
> 
> plot(model_sirdconn,  main = "SIRDCONN Model")
> 
> 
> 
> cleanEx()
> nameEx("ModelSIRLogit")
> ### * ModelSIRLogit
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSIRLogit
> ### Title: SIR Logistic model
> ### Aliases: ModelSIRLogit
> 
> ### ** Examples
> 
> set.seed(2223)
> n <- 100000
> 
> # Creating the data to use for the "ModelSIRLogit" function. It contains
> # information on the sex of each agent and will be used to determine
> # differences in disease progression between males and females. Note that
> # the number of rows in these data are identical to n (100000).
> X <- cbind(
+   Intercept = 1,
+   Female    = sample.int(2, n, replace = TRUE) - 1
+ )
> 
> # Declare coefficients for each sex regarding transmission_rate and recovery.
> coef_infect  <- c(.1, -2, 2)
> coef_recover <- rnorm(2)
> 
> # Feed all above information into the "ModelSIRLogit" function.
> model_logit <- ModelSIRLogit(
+   "covid2",
+   data = X,
+   coefs_infect      = coef_infect,
+   coefs_recover     = coef_recover,
+   coef_infect_cols  = 1L:ncol(X),
+   coef_recover_cols = 1L:ncol(X),
+   prob_infection = .8,
+   recovery_rate = .3,
+   prevalence = .01
+ )
> 
> agents_smallworld(model_logit, n, 8, FALSE, .01)
> 
> run(model_logit, 50)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> 
> plot(model_logit)
> 
> # Females are supposed to be more likely to become infected.
> rn <- get_reproductive_number(model_logit)
> 
> # Probability of infection for males and females.
> (table(
+   X[, "Female"],
+   (1:n %in% rn$source)
+ ) |> prop.table())[, 2]
      0       1 
0.20717 0.22397 
> 
> # Looking into the individual agents.
> get_agents(model_logit)
Agents from the model "Susceptible-Infected-Removed (SIR) (logit)":
Agent: 0, state: Susceptible (0), Has virus: no, NTools: 0i NNeigh: 8
Agent: 1, state: Susceptible (0), Has virus: no, NTools: 0i NNeigh: 8
Agent: 2, state: Susceptible (0), Has virus: no, NTools: 0i NNeigh: 8
Agent: 3, state: Susceptible (0), Has virus: no, NTools: 0i NNeigh: 8
Agent: 4, state: Susceptible (0), Has virus: no, NTools: 0i NNeigh: 8
Agent: 5, state: Susceptible (0), Has virus: no, NTools: 0i NNeigh: 8
Agent: 6, state: Susceptible (0), Has virus: no, NTools: 0i NNeigh: 8
Agent: 7, state: Susceptible (0), Has virus: no, NTools: 0i NNeigh: 8
Agent: 8, state: Susceptible (0), Has virus: no, NTools: 0i NNeigh: 8
Agent: 9, state: Susceptible (0), Has virus: no, NTools: 0i NNeigh: 8
... 99990 more agents ...
> 
> 
> 
> cleanEx()
> nameEx("ModelSIRMixing")
> ### * ModelSIRMixing
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSIRMixing
> ### Title: Susceptible Infected Removed model (SIR) with mixing
> ### Aliases: ModelSIRMixing epiworld_sirmixing
> 
> ### ** Examples
> 
> # From the vignette
> 
> # Start off creating three entities.
> # Individuals will be distribured randomly between the three.
> e1 <- entity("Population 1", 3e3, as_proportion = FALSE)
> e2 <- entity("Population 2", 3e3, as_proportion = FALSE)
> e3 <- entity("Population 3", 3e3, as_proportion = FALSE)
> 
> # Row-stochastic matrix (rowsums 1)
> cmatrix <- c(
+   c(0.9, 0.05, 0.05),
+   c(0.1, 0.8, 0.1),
+   c(0.1, 0.2, 0.7)
+ ) |> matrix(byrow = TRUE, nrow = 3)
> 
> N <- 9e3
> 
> flu_model <- ModelSIRMixing(
+   name              = "Flu",
+   n                 = N,
+   prevalence        = 1 / N,
+   contact_rate      = 20,
+   transmission_rate = 0.1,
+   recovery_rate     = 1 / 7,
+   contact_matrix    = cmatrix
+ )
> 
> # Adding the entities to the model
> flu_model |>
+   add_entity(e1) |>
+   add_entity(e2) |>
+   add_entity(e3)
> 
> set.seed(331)
> run(flu_model, ndays = 100)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> summary(flu_model)
________________________________________________________________________________
________________________________________________________________________________
SIMULATION STUDY

Name of the model   : Susceptible-Infected-Removed (SIR) with Mixing
Population size     : 9000
Agents' data        : (none)
Number of entities  : 3
Days (duration)     : 100 (of 100)
Number of viruses   : 1
Last run elapsed t  : 111.00ms
Last run speed      : 8.04 million agents x day / second
Rewiring            : off

Global events:
 - Update infected individuals (runs daily)

Virus(es):
 - Flu

Tool(s):
 (none)

Model parameters:
 - Contact rate       : 20.0000
 - Prob. Recovery     : 0.1429
 - Prob. Transmission : 0.1000

Distribution of the population at time 100:
  - (0) Susceptible : 8999 -> 1
  - (1) Infected    :    1 -> 0
  - (2) Recovered   :    0 -> 8999

Transition Probabilities:
 - Susceptible  0.91  0.09     -
 - Infected        -  0.86  0.14
 - Recovered       -     -  1.00

> plot_incidence(flu_model)
> 
> 
> 
> 
> cleanEx()
> nameEx("ModelSIS")
> ### * ModelSIS
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSIS
> ### Title: SIS model
> ### Aliases: ModelSIS epiworld_sis
> 
> ### ** Examples
> 
> model_sis <- ModelSIS(name = "COVID-19", prevalence = 0.01,
+   transmission_rate = 0.9, recovery_rate = 0.1)
> 
> # Adding a small world population
> agents_smallworld(
+   model_sis,
+   n = 1000,
+   k = 5,
+   d = FALSE,
+   p = .01
+ )
> 
> # Running and printing
> run(model_sis, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_sis
________________________________________________________________________________
Susceptible-Infected-Susceptible (SIS)
It features 1000 agents, 1 virus(es), and 0 tool(s).
The model has 2 states.
The final distribution is: 87 Susceptible, and 913 Infected.
> 
> # Plotting
> plot(model_sis, main = "SIS Model")
> 
> 
> 
> 
> cleanEx()
> nameEx("ModelSISD")
> ### * ModelSISD
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSISD
> ### Title: SISD model
> ### Aliases: ModelSISD epiworld_sisd
> 
> ### ** Examples
> 
> model_sisd <- ModelSISD(
+   name = "COVID-19",
+   prevalence = 0.01,
+   transmission_rate = 0.9,
+   recovery_rate = 0.1,
+   death_rate = 0.01
+ )
> 
> # Adding a small world population
> agents_smallworld(
+   model_sisd,
+   n = 1000,
+   k = 5,
+   d = FALSE,
+   p = .01
+ )
> 
> # Running and printing
> run(model_sisd, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_sisd
________________________________________________________________________________
Susceptible-Infected-Susceptible-Deceased (SISD)
It features 1000 agents, 1 virus(es), and 0 tool(s).
The model has 3 states.
The final distribution is: 95 Susceptible, 406 Infected, and 499 Deceased.
> 
> # Plotting
> plot(model_sisd, main = "SISD Model")
> 
> 
> 
> 
> cleanEx()
> nameEx("ModelSURV")
> ### * ModelSURV
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: ModelSURV
> ### Title: SURV model
> ### Aliases: ModelSURV epiworld_surv
> 
> ### ** Examples
> 
> model_surv <- ModelSURV(
+   name                  = "COVID-19",
+   prevalence            = 20,
+   efficacy_vax          = 0.6,
+   latent_period         = 4,
+   infect_period         = 5,
+   prob_symptoms         = 0.5,
+   prop_vaccinated       = 0.7,
+   prop_vax_redux_transm = 0.8,
+   prop_vax_redux_infect = 0.95,
+   surveillance_prob     = 0.1,
+   transmission_rate     = 0.2,
+   prob_death            = 0.001,
+   prob_noreinfect       = 0.5
+ )
> 
> # Adding a small world population
> agents_smallworld(
+   model_surv,
+   n = 10000,
+   k = 5,
+   d = FALSE,
+   p = .01
+ )
> 
> # Running and printing
> run(model_surv, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_surv
________________________________________________________________________________
Surveillance
It features 10000 agents, 1 virus(es), and 1 tool(s).
The model has 8 states.
The final distribution is: 9975 Susceptible, 0 Latent, 0 Symptomatic, 0 Symptomatic isolated, 0 Asymptomatic, 0 Asymptomatic isolated, 25 Recovered, and 0 Removed.
> 
> # Plotting
> plot(model_surv, main = "SURV Model")
> 
> 
> 
> 
> cleanEx()
> nameEx("add_entities_from_dataframe")
> ### * add_entities_from_dataframe
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: add_entities_from_dataframe
> ### Title: Add entities to a model according to a data.frame
> ### Aliases: add_entities_from_dataframe
> 
> ### ** Examples
> 
> # Start off creating three entities.
> # Individuals will be distributed randomly between the three.
> entities <- data.frame(
+   name = c("Pop 1", "Pop 2", "Pop 3"),
+   size = rep(3e3, 3)
+ )
> 
> # Row-stochastic matrix (rowsums 1)
> cmatrix <- c(
+   c(0.9, 0.05, 0.05),
+   c(0.1, 0.8, 0.1),
+   c(0.1, 0.2, 0.7)
+ ) |> matrix(byrow = TRUE, nrow = 3)
> 
> flu_model <- ModelSIRMixing(
+   name              = "Flu",
+   n                 = 9e3,
+   prevalence        = 1 / 9e3,
+   contact_rate      = 20,
+   transmission_rate = 0.1,
+   recovery_rate     = 1 / 7,
+   contact_matrix    = cmatrix
+ ) |>
+   add_entities_from_dataframe(
+     entities = entities,
+     col_name = "name",
+     col_number = "size",
+     # This is passed to `add_entity()`
+     as_proportion = FALSE
+   )
> 
> 
> 
> cleanEx()
> nameEx("agents")
> ### * agents
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: agents
> ### Title: Agents in epiworldR
> ### Aliases: agents get_agents epiworld_agents get_agents.epiworld_model
> ###   [.epiworld_agents epiworld_agent print.epiworld_agent
> ###   print.epiworld_agents get_state
> 
> ### ** Examples
> 
> 
> model_sirconn <- ModelSIRCONN(
+   name                = "COVID-19",
+   n                   = 10000,
+   prevalence          = 0.01,
+   contact_rate        = 5,
+   transmission_rate   = 0.4,
+   recovery_rate       = 0.95
+ )
> 
> run(model_sirconn, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> 
> x <- get_agents(model_sirconn) # Storing all agent information into object of
> # class epiworld_agents
> 
> print(x, compressed = FALSE, max_print = 5) # Displaying detailed information of
Agents from the model "Susceptible-Infected-Removed (SIR) (connected)":
Information about agent id 0
  State        : Susceptible (0)
  Has virus    : no
  Tool count   : 0
  Neigh. count : 0
Information about agent id 1
  State        : Recovered (2)
  Has virus    : no
  Tool count   : 0
  Neigh. count : 0
Information about agent id 2
  State        : Susceptible (0)
  Has virus    : no
  Tool count   : 0
  Neigh. count : 0
Information about agent id 3
  State        : Susceptible (0)
  Has virus    : no
  Tool count   : 0
  Neigh. count : 0
Information about agent id 4
  State        : Susceptible (0)
  Has virus    : no
  Tool count   : 0
  Neigh. count : 0
... 9995 more agents ...
> # the first 5 agents using
> # compressed=F. Using compressed=T
> # results in less-detailed
> # information about each agent.
> 
> x[0] # Print information about the first agent. Substitute the agent of
Information about agent id 0
  State        : Susceptible (0)
  Has virus    : no
  Tool count   : 0
  Neigh. count : 0
> # interest's position where '0' is.
> 
> 
> 
> cleanEx()
> nameEx("agents_smallworld")
> ### * agents_smallworld
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: agents_smallworld
> ### Title: Load agents to a model
> ### Aliases: agents_smallworld agents_from_edgelist get_network network
> ###   get_agents_states add_virus_agent add_tool_agent has_virus has_tool
> ###   change_state get_agents_tools
> 
> ### ** Examples
> 
> 
> # Initializing SIR model with agents_smallworld
> sir <- ModelSIR(name = "COVID-19", prevalence = 0.01, transmission_rate = 0.9,
+   recovery_rate = 0.1)
> agents_smallworld(
+   sir,
+   n = 1000,
+   k = 5,
+   d = FALSE,
+   p = .01
+ )
> run(sir, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> sir
________________________________________________________________________________
Susceptible-Infected-Recovered (SIR)
It features 1000 agents, 1 virus(es), and 0 tool(s).
The model has 3 states.
The final distribution is: 0 Susceptible, 0 Infected, and 1000 Recovered.
> 
> # We can also retrieve the network
> net <- get_network(sir)
> head(net)
  from  to
1    0   1
2    0   2
3    0 998
4    0 999
5    1   2
6    1   3
> 
> # Simulating a bernoulli graph
> set.seed(333)
> n <- 1000
> g <- matrix(runif(n^2) < .01, nrow = n)
> diag(g) <- FALSE
> el <- which(g, arr.ind = TRUE) - 1L
> 
> 
> # Generating an empty model
> sir <- ModelSIR("COVID-19", .01, .8, .3)
> agents_from_edgelist(
+   sir,
+   source = el[, 1],
+   target = el[, 2],
+   size   = n,
+   directed = TRUE
+ )
> 
> # Running the simulation
> run(sir, 50)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> 
> plot(sir)
> 
> 
> 
> cleanEx()
> nameEx("entities")
> ### * entities
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: entities
> ### Title: Get entities
> ### Aliases: entities get_entities [.epiworld_entities entity
> ###   get_entity_size get_entity_name entity_add_agent rm_entity add_entity
> ###   load_agents_entities_ties entity_get_agents
> ###   distribute_entity_randomly distribute_entity_to_set
> ###   set_distribution_entity
> 
> ### ** Examples
> 
> # Creating a mixing model
> mymodel <- ModelSIRMixing(
+   name = "My model",
+   n = 10000,
+   prevalence = .001,
+   contact_rate = 10,
+   transmission_rate = .1,
+   recovery_rate = 1 / 7,
+   contact_matrix = matrix(c(.9, .1, .1, .9), 2, 2)
+ )
> 
> ent1 <- entity("First", 5000, FALSE)
> ent2 <- entity("Second", 5000, FALSE)
> 
> mymodel |>
+   add_entity(ent1) |>
+   add_entity(ent2)
> 
> run(mymodel, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> 
> summary(mymodel)
________________________________________________________________________________
________________________________________________________________________________
SIMULATION STUDY

Name of the model   : Susceptible-Infected-Removed (SIR) with Mixing
Population size     : 10000
Agents' data        : (none)
Number of entities  : 2
Days (duration)     : 100 (of 100)
Number of viruses   : 1
Last run elapsed t  : 117.00ms
Last run speed      : 8.50 million agents x day / second
Rewiring            : off

Global events:
 - Update infected individuals (runs daily)

Virus(es):
 - My model

Tool(s):
 (none)

Model parameters:
 - Contact rate       : 10.0000
 - Prob. Recovery     : 0.1429
 - Prob. Transmission : 0.1000

Distribution of the population at time 100:
  - (0) Susceptible :  9990 -> 24
  - (1) Infected    :    10 -> 0
  - (2) Recovered   :     0 -> 9976

Transition Probabilities:
 - Susceptible  0.92  0.08     -
 - Infected        -  0.86  0.14
 - Recovered       -     -  1.00

> 
> 
> 
> cleanEx()
> nameEx("epiworld-gentime")
> ### * epiworld-gentime
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: epiworld-gentime
> ### Title: Generation time
> ### Aliases: epiworld-gentime epiworld_generation_time get_generation_time
> ###   plot.epiworld_generation_time plot_generation_time
> 
> ### ** Examples
> 
> # SEIR Connected model
> seirconn <- ModelSEIRCONN(
+   name              = "Disease",
+   n                 = 10000,
+   prevalence        = 0.1,
+   contact_rate      = 2.0,
+   transmission_rate = 0.8,
+   incubation_days   = 7.0,
+   recovery_rate     = 0.3
+ )
> 
> set.seed(937)
> run(seirconn, 50)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> 
> # Get and plot generation time
> gent <- plot_generation_time(seirconn)
> 
> 
> 
> 
> cleanEx()
> nameEx("epiworld-history")
> ### * epiworld-history
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: epiworld-history
> ### Title: Model history and totals
> ### Aliases: epiworld-history get_hist_total epiworld_hist_total
> ###   get_today_total plot.epiworld_hist get_hist_virus epiworld_hist_virus
> ###   get_hist_tool epiworld_hist_tool
> 
> ### ** Examples
> 
> # SEIR Connected model
> seirconn <- ModelSEIRCONN(
+   name              = "Disease",
+   n                 = 10000,
+   prevalence        = 0.1,
+   contact_rate      = 2.0,
+   transmission_rate = 0.8,
+   incubation_days   = 7.0,
+   recovery_rate     = 0.3
+ )
> 
> # Running the simulation for 50 steps (days)
> set.seed(937)
> run(seirconn, 50)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> 
> # Retrieving date, state, and counts dataframe including any added tools
> get_hist_tool(seirconn)
[1] date    tool_id tool    state   counts 
<0 rows> (or 0-length row.names)
> 
> # Retrieving overall date, state, and counts dataframe
> head(get_hist_total(seirconn))
  date       state counts
1    0 Susceptible   9000
2    0     Exposed   1000
3    0    Infected      0
4    0   Recovered      0
5    1 Susceptible   9000
6    1     Exposed    861
> 
> # Retrieving date, state, and counts dataframe by variant
> head(get_hist_virus(seirconn))
  date virus_id   virus       state counts
1    0        0 Disease Susceptible      0
2    0        0 Disease     Exposed   1000
3    0        0 Disease    Infected      0
4    0        0 Disease   Recovered      0
5    1        0 Disease Susceptible      0
6    1        0 Disease     Exposed    861
> 
> # Snapshot of totals at end of simulation
> get_today_total(seirconn)
Susceptible     Exposed    Infected   Recovered 
         50          45          41        9864 
> 
> 
> 
> 
> cleanEx()
> nameEx("epiworld-hospitalizations")
> ### * epiworld-hospitalizations
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: epiworld-hospitalizations
> ### Title: Hospitalizations by tool
> ### Aliases: epiworld-hospitalizations get_hospitalizations
> 
> ### ** Examples
> 
> # See model documentation for examples with hospitalization tracking
> 
> 
> 
> cleanEx()
> nameEx("epiworld-methods")
> ### * epiworld-methods
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: epiworld-methods
> ### Title: Methods for epiworldR objects
> ### Aliases: epiworld-methods queuing_on epiworld_model queuing_off
> ###   verbose_off verbose_on run summary.epiworld_model get_states
> ###   get_param add_param add_param.epiworld_model set_param set_name
> ###   get_name get_n_viruses get_n_tools get_ndays today get_n_replicates
> ###   size set_agents_data get_agents_data_ncols get_virus get_tool
> ###   initial_states clone_model draw_mermaid
> 
> ### ** Examples
> 
> 
> model_sirconn <- ModelSIRCONN(
+   name                = "COVID-19",
+   n                   = 10000,
+   prevalence          = 0.01,
+   contact_rate        = 5,
+   transmission_rate   = 0.4,
+   recovery_rate       = 0.95
+ )
> 
> # Queuing - If you wish to implement the queuing function, declare whether
> # you would like it "on" or "off", if any.
> queuing_on(model_sirconn)
Warning in queuing_on.epiworld_sirconn(model_sirconn) :
  SIR Connected models do not have queue.
> queuing_off(model_sirconn)
Warning in queuing_off.epiworld_sirconn(model_sirconn) :
  SIR Connected models do not have queue.
> run(model_sirconn, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> 
> # Verbose - "on" prints the progress bar on the screen while "off"
> # deactivates the progress bar. Declare which function you want to implement,
> # if any.
> verbose_on(model_sirconn)
> verbose_off(model_sirconn)
> run(model_sirconn, ndays = 100, seed = 1912)
> 
> get_states(model_sirconn) # Returns all unique states found within the model.
[1] "Susceptible" "Infected"    "Recovered"  
> 
> get_param(model_sirconn, "Contact rate") # Returns the value of the selected
[1] 5
> # parameter within the model object.
> # In order to view the parameters,
> # run the model object and find the
> # "Model parameters" section.
> 
> set_param(model_sirconn, "Contact rate", 2) # Allows for adjustment of model
> # parameters within the model
> # object. In this example, the
> # Contact rate parameter is
> # changed to 2. You can now rerun
> # the model to observe any
> # differences.
> 
> set_name(model_sirconn, "My Epi-Model") # This function allows for setting
> # a name for the model. Running the
> # model object, the name of the model
> # is now reflected next to "Name of
> # the model".
> 
> get_name(model_sirconn) # Returns the set name of the model.
[1] "My Epi-Model"
> 
> get_n_viruses(model_sirconn) # Returns the number of viruses in the model.
[1] 1
> # In this case, there is only one virus:
> # "COVID-19".
> 
> get_n_tools(model_sirconn) # Returns the number of tools in the model. In
[1] 0
> # this case, there are zero tools.
> 
> get_ndays(model_sirconn) # Returns the length of the simulation in days. This
[1] 100
> # will match "ndays" within the "run" function.
> 
> today(model_sirconn) # Returns the current day of the simulation. This will
[1] 100
> # match "get_ndays()" if run at the end of a simulation, but will differ if run
> # during a simulation
> 
> get_n_replicates(model_sirconn) # Returns the number of replicates of the
[1] 2
> # model.
> 
> size(model_sirconn) # Returns the population size in the model. In this case,
[1] 10000
> # there are 10,000 agents in the model.
> # Set Agents Data
> # First, your data matrix must have the same number of rows as agents in the
> # model. Below is a generated matrix which will be passed into the
> # "set_agents_data" function.
> data <- matrix(data = runif(20000, min = 0, max = 100), nrow = 10000, ncol = 2)
> set_agents_data(model_sirconn, data)
> get_agents_data_ncols(model_sirconn) # Returns number of columns
[1] 2
> 
> get_virus(model_sirconn, 0) # Returns information about the first virus in
Virus         : COVID-19
Id            : 0
state_init    : 1
state_post    : 2
state_removed : 2
queue_init    : 2
queue_post    : -2
queue_removed : -2
> # the model (index begins at 0).
> 
> add_tool(model_sirconn, tool("Vaccine", .9, .9, .5, 1, prevalence = 0.5, as_prop = TRUE))
> get_tool(model_sirconn, 0) # Returns information about the first tool in the
Tool       : Vaccine
Id         : 0
state_init : -99
state_post : -99
queue_init : 0
queue_post : 0
> # model. In this case, there are no tools so an
> # error message will occur.
> 
> # Draw a mermaid diagram of the transitions
> draw_mermaid(model_sirconn)
flowchart TB
	s0[Infected]
	s1[Recovered]
	s2[Susceptible]
	s0 -->|0.950161| s1
	s2 -->|0.031401| s0

> 
> 
> 
> cleanEx()
> nameEx("epiworld-model-diagram")
> ### * epiworld-model-diagram
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: print.epiworld_diagram
> ### Title: Model Diagram
> ### Aliases: print.epiworld_diagram plot.epiworld_diagram
> ###   epiworld-model-diagram draw_mermaid_from_data
> ###   draw_mermaid_from_matrix draw_mermaid_from_file
> ###   draw_mermaid_from_files
> 
> ### ** Examples
> 
> # Create and run a model
> model <- ModelSIRCONN(
+   name = "A Virus",
+   n = 10000,
+   prevalence = .01,
+   contact_rate = 4.0,
+   transmission_rate = .5,
+   recovery_rate = 1.0 / 7.0
+ )
> 
> verbose_off(model)
> run(model, ndays = 50, seed = 1912)
> 
> # Draw mermaid diagrams from model data
> diagram <- draw_mermaid_from_data(
+   states = get_states(model),
+   transition_probs = c(get_transition_probability(model))
+ )
> 
> ## Not run: 
> ##D # If DiagrammeR is installed, we can plot the diagram
> ##D plot(diagram)
> ## End(Not run)
> 
> 
> 
> cleanEx()
> nameEx("epiworld-repnum")
> ### * epiworld-repnum
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: epiworld-repnum
> ### Title: Reproductive number (Rt)
> ### Aliases: epiworld-repnum get_reproductive_number epiworld_repnum
> ###   plot.epiworld_repnum plot_reproductive_number
> 
> ### ** Examples
> 
> # SEIR Connected model
> seirconn <- ModelSEIRCONN(
+   name              = "Disease",
+   n                 = 10000,
+   prevalence        = 0.1,
+   contact_rate      = 2.0,
+   transmission_rate = 0.8,
+   incubation_days   = 7.0,
+   recovery_rate     = 0.3
+ )
> 
> set.seed(937)
> run(seirconn, 50)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> 
> # Retrieving (and plotting) the reproductive number
> rp <- get_reproductive_number(seirconn)
> plot(rp) # Also equivalent to plot_reproductive_number(seirconn)
> 
> 
> 
> 
> cleanEx()
> nameEx("epiworld-summaries")
> ### * epiworld-summaries
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: epiworld-summaries
> ### Title: Summary counts and probabilities
> ### Aliases: epiworld-summaries get_transition_probability get_active_cases
> ###   get_outbreak_size
> 
> ### ** Examples
> 
> # SEIR Connected model
> seirconn <- ModelSEIRCONN(
+   name              = "Disease",
+   n                 = 10000,
+   prevalence        = 0.1,
+   contact_rate      = 2.0,
+   transmission_rate = 0.8,
+   incubation_days   = 7.0,
+   recovery_rate     = 0.3
+ )
> 
> set.seed(937)
> run(seirconn, 50)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> 
> # Retrieving the transition probability
> get_transition_probability(seirconn)
            Susceptible    Exposed  Infected Recovered
Susceptible   0.9113965 0.08860354 0.0000000 0.0000000
Exposed       0.0000000 0.85694473 0.1430553 0.0000000
Infected      0.0000000 0.00000000 0.6974602 0.3025398
Recovered     0.0000000 0.00000000 0.0000000 1.0000000
> 
> # Get active cases
> head(get_active_cases(seirconn))
  date virus_id   virus active_cases
1    0        0 Disease         1000
2    1        0 Disease         1000
3    2        0 Disease         1131
4    3        0 Disease         1346
5    4        0 Disease         1611
6    5        0 Disease         1988
> 
> # Get outbreak size
> head(get_outbreak_size(seirconn))
  date virus_id   virus outbreak_size
1    0        0 Disease          1000
2    1        0 Disease          1000
3    2        0 Disease          1178
4    3        0 Disease          1466
5    4        0 Disease          1820
6    5        0 Disease          2297
> 
> 
> 
> 
> cleanEx()
> nameEx("epiworld-transition")
> ### * epiworld-transition
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: epiworld-transition
> ### Title: Transition dynamics and incidence
> ### Aliases: epiworld-transition epiworld_hist_transition
> ###   get_hist_transition_matrix as.array.epiworld_hist_transition
> ###   plot_incidence plot.epiworld_hist_transition
> 
> ### ** Examples
> 
> # SEIR Connected model
> seirconn <- ModelSEIRCONN(
+   name              = "Disease",
+   n                 = 10000,
+   prevalence        = 0.1,
+   contact_rate      = 2.0,
+   transmission_rate = 0.8,
+   incubation_days   = 7.0,
+   recovery_rate     = 0.3
+ )
> 
> set.seed(937)
> run(seirconn, 50)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> 
> # Get the transition history
> t_hist <- get_hist_transition_matrix(seirconn)
> head(t_hist)
   state_from    state_to date counts
1 Susceptible Susceptible    0   9000
2     Exposed Susceptible    0      0
3    Infected Susceptible    0      0
4   Recovered Susceptible    0      0
5 Susceptible     Exposed    0   1000
6     Exposed     Exposed    0      0
> 
> # Convert to array
> as.array(t_hist)[, , 1:3]
, , 0

            Susceptible Exposed Infected Recovered
Susceptible        9000    1000        0         0
Exposed               0       0        0         0
Infected              0       0        0         0
Recovered             0       0        0         0

, , 1

            Susceptible Exposed Infected Recovered
Susceptible        9000       0        0         0
Exposed               0     861      139         0
Infected              0       0        0         0
Recovered             0       0        0         0

, , 2

            Susceptible Exposed Infected Recovered
Susceptible        8822     178        0         0
Exposed               0     737      124         0
Infected              0       0       92        47
Recovered             0       0        0         0

> 
> # Plot incidence
> inci <- plot_incidence(seirconn)
> 
> 
> 
> 
> cleanEx()
> nameEx("epiworld-transmissions")
> ### * epiworld-transmissions
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: epiworld-transmissions
> ### Title: Transmission network
> ### Aliases: epiworld-transmissions get_transmissions
> 
> ### ** Examples
> 
> # SEIR Connected model
> seirconn <- ModelSEIRCONN(
+   name              = "Disease",
+   n                 = 10000,
+   prevalence        = 0.1,
+   contact_rate      = 2.0,
+   transmission_rate = 0.8,
+   incubation_days   = 7.0,
+   recovery_rate     = 0.3
+ )
> 
> set.seed(937)
> run(seirconn, 50)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> 
> # Get transmission data
> head(get_transmissions(seirconn))
  date source target virus_id   virus source_exposure_date
1    0     -1   6653        0 Disease                    0
2    0     -1   9871        0 Disease                    0
3    0     -1   6580        0 Disease                    0
4    0     -1   7067        0 Disease                    0
5    0     -1   1113        0 Disease                    0
6    0     -1   1991        0 Disease                    0
> 
> 
> 
> 
> cleanEx()
> nameEx("global-events")
> ### * global-events
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: global-events
> ### Title: Global Events
> ### Aliases: global-events globalevent_tool global-actions
> ###   epiworld_globalevent_set_param epiworld_globalevent_tool
> ###   epiworld_globalevent_tool_logit epiworld_globalevent actions
> ###   globalevent_tool_logit globalevent_set_params globalevent_fun
> ###   add_globalevent rm_globalevent
> 
> ### ** Examples
> 
> # Simple model
> model_sirconn <- ModelSIRCONN(
+   name                = "COVID-19",
+   n                   = 10000,
+   prevalence          = 0.01,
+   contact_rate        = 5,
+   transmission_rate   = 0.4,
+   recovery_rate       = 0.95
+ )
> 
> # Creating a tool
> epitool <- tool(
+   name = "Vaccine",
+   prevalence = 0,
+   as_proportion = FALSE,
+   susceptibility_reduction = .9,
+   transmission_reduction = .5,
+   recovery_enhancer = .5,
+   death_reduction = .9
+ )
> 
> 
> # Adding a global event
> vaccine_day_20 <- globalevent_tool(epitool, .2, day = 20)
> add_globalevent(model_sirconn, vaccine_day_20)
> 
> # Running and printing
> run(model_sirconn, ndays = 40, seed = 1912)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> model_sirconn
________________________________________________________________________________
Susceptible-Infected-Removed (SIR) (connected)
It features 10000 agents, 1 virus(es), and 1 tool(s).
The model has 3 states.
The final distribution is: 2012 Susceptible, 0 Infected, and 7988 Recovered.
> plot_incidence(model_sirconn)
> 
> # Example 2: Changing the contact rate -------------------------------------
> model_sirconn2 <- ModelSIRCONN(
+   name                = "COVID-19",
+   n                   = 10000,
+   prevalence          = 0.01,
+   contact_rate        = 5,
+   transmission_rate   = 0.4,
+   recovery_rate       = 0.95
+ )
> 
> closure_day_10 <- globalevent_set_params("Contact rate", 0, day = 10)
> add_globalevent(model_sirconn2, closure_day_10)
> 
> # Running and printing
> run(model_sirconn2, ndays = 40, seed = 1912)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> model_sirconn2
________________________________________________________________________________
Susceptible-Infected-Removed (SIR) (connected)
It features 10000 agents, 1 virus(es), and 0 tool(s).
The model has 3 states.
The final distribution is: 2083 Susceptible, 0 Infected, and 7917 Recovered.
> plot_incidence(model_sirconn2)
> # Example using `globalevent_fun` to record the state of the
> # agents at each time step.
> 
> # We start by creating an SIR connected model
> model <- ModelSIRCONN(
+   name              = "SIR with Global Saver",
+   n                 = 1000,
+   prevalence        = 0.01,
+   contact_rate      = 5,
+   transmission_rate = 0.4,
+   recovery_rate     = 0.3
+ )
> 
> # We create the object where the history of the agents will be stored
> agents_history <- NULL
> 
> # This function prints the total number of agents in each state
> # and stores the history of the agents in the object `agents_history`
> hist_saver <- function(m) {
+ 
+   message("Today's totals are: ", paste(get_today_total(m), collapse = ", "))
+ 
+   # We use the `<<-` operator to assign the value to the global variable
+   # `agents_history` (see ?"<<-")
+   agents_history <<- cbind(
+     agents_history,
+     get_agents_states(m)
+   )
+ 
+ }
> 
> # We create the global event that will execute the function `hist_saver`
> # at each time step
> hist_saver_event <- globalevent_fun(hist_saver, "Agent History Saver")
> 
> # We add the global event to the model
> model <- add_globalevent(model, hist_saver_event)
> 
> 
> 
> cleanEx()
> nameEx("run_multiple")
> ### * run_multiple
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: run_multiple
> ### Title: Run multiple simulations at once
> ### Aliases: run_multiple run_multiple_get_results make_saver
> ###   epiworld_saver
> 
> ### ** Examples
> 
> model_sir <- ModelSIRCONN(
+   name = "COVID-19",
+   prevalence = 0.01,
+   n = 1000,
+   contact_rate = 2,
+   transmission_rate = 0.9, recovery_rate = 0.1
+ )
> 
> # Generating a saver
> saver <- make_saver("total_hist", "reproductive")
> 
> # Running and printing
> run_multiple(model_sir, ndays = 100, nsims = 50, saver = saver, nthreads = 2)
Starting multiple runs (50) using 2 thread(s)
_________________________________________________________________________
_________________________________________________________________________
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> 
> # Retrieving the results
> ans <- run_multiple_get_results(model_sir, nthreads = 2)
> 
> head(ans$total_hist)
  sim_num date nviruses       state counts
1       1    0        1 Susceptible    990
2       1    0        1    Infected     10
3       1    0        1   Recovered      0
4       1    1        1 Susceptible    968
5       1    1        1    Infected     31
6       1    1        1   Recovered      1
> head(ans$reproductive)
  sim_num virus_id    virus source source_exposure_date rt
1       1        0 COVID-19    637                   10  0
2       1        0 COVID-19    738                    9  0
3       1        0 COVID-19    656                    9  0
4       1        0 COVID-19    458                    8  0
5       1        0 COVID-19    234                    8  0
6       1        0 COVID-19    918                    7  0
> 
> # Plotting
> multi_sir <- ans$total_hist
> multi_sir <- multi_sir[multi_sir$date <= 20, ]
> plot(multi_sir)
> 
> 
> 
> 
> cleanEx()
> nameEx("tool")
> ### * tool
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: tool
> ### Title: Tools in epiworld
> ### Aliases: tool epiworld_tool set_name_tool get_name_tool add_tool
> ###   rm_tool tool_fun_logit set_susceptibility_reduction
> ###   set_susceptibility_reduction_ptr set_susceptibility_reduction_fun
> ###   set_transmission_reduction set_transmission_reduction_ptr
> ###   set_transmission_reduction_fun set_recovery_enhancer
> ###   set_recovery_enhancer_ptr set_recovery_enhancer_fun
> ###   set_death_reduction set_death_reduction_ptr set_death_reduction_fun
> ###   print.epiworld_agents_tools set_distribution_tool
> ###   distribute_tool_randomly distribute_tool_to_set
> ###   distribute_tool_to_entities
> 
> ### ** Examples
> 
> # Simple model
> model_sirconn <- ModelSIRCONN(
+   name                = "COVID-19",
+   n                   = 10000,
+   prevalence          = 0.01,
+   contact_rate        = 5,
+   transmission_rate   = 0.4,
+   recovery_rate       = 0.95
+ )
> 
> # Running and printing
> run(model_sirconn, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> plot(model_sirconn)
> 
> epitool <- tool(
+   name = "Vaccine",
+   prevalence = 0.5,
+   as_proportion = TRUE,
+   susceptibility_reduction = .9,
+   transmission_reduction = .5,
+   recovery_enhancer = .5,
+   death_reduction = .9
+ )
> 
> epitool
Tool       : Vaccine
Id         : (empty)
state_init : -99
state_post : -99
queue_init : 0
queue_post : 0
> 
> set_name_tool(epitool, "Pfizer") # Assigning name to the tool
> get_name_tool(epitool) # Returning the name of the tool
[1] "Pfizer"
> add_tool(model_sirconn, epitool)
> run(model_sirconn, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> model_sirconn
________________________________________________________________________________
Susceptible-Infected-Removed (SIR) (connected)
It features 10000 agents, 1 virus(es), and 1 tool(s).
The model has 3 states.
The final distribution is: 8804 Susceptible, 0 Infected, and 1196 Recovered.
> plot(model_sirconn)
> 
> # To declare a certain number of individuals with the tool
> rm_tool(model_sirconn, 0) # Removing epitool from the model
> # Setting prevalence to 0.1
> set_distribution_tool(epitool, distribute_tool_randomly(0.1, TRUE))
> add_tool(model_sirconn, epitool)
> run(model_sirconn, ndays = 100, seed = 1912)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> 
> # Adjusting probabilities due to tool
> set_susceptibility_reduction(epitool, 0.1) # Susceptibility reduction
Tool       : Pfizer
Id         : 0
state_init : -99
state_post : -99
queue_init : 0
queue_post : 0
> set_transmission_reduction(epitool, 0.2) # Transmission reduction
> set_recovery_enhancer(epitool, 0.15) # Probability increase of recovery
> set_death_reduction(epitool, 0.05) # Probability reduction of death
> 
> rm_tool(model_sirconn, 0)
> add_tool(model_sirconn, epitool)
> run(model_sirconn, ndays = 100, seed = 1912) # Run model to view changes
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> 
> 
> # Using the logit function --------------
> sir <- ModelSIR(
+   name = "COVID-19", prevalence = 0.01,
+   transmission_rate = 0.9, recovery_rate = 0.1
+ )
> 
> # Adding a small world population
> agents_smallworld(
+   sir,
+   n = 10000,
+   k = 5,
+   d = FALSE,
+   p = .01
+ )
> 
> # Creating a tool
> mask_wearing <- tool(
+   name = "Mask",
+   prevalence               = 0.5,
+   as_proportion            = TRUE,
+   susceptibility_reduction = 0.0,
+   transmission_reduction   = 0.3, # Only transmission
+   recovery_enhancer        = 0.0,
+   death_reduction          = 0.0
+ )
> 
> add_tool(sir, mask_wearing)
> 
> run(sir, ndays = 50, seed = 11)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> hist_0 <- get_hist_total(sir)
> 
> # And adding features
> dat <- cbind(
+   female = sample.int(2, 10000, replace = TRUE) - 1,
+   x      = rnorm(10000)
+ )
> 
> set_agents_data(sir, dat)
> 
> # Creating the logit function
> tfun <- tool_fun_logit(
+   vars  = c(0L, 1L),
+   coefs = c(-1, 1),
+   model = sir
+ )
> 
> # The infection prob is lower
> hist(plogis(dat %*% rbind(.5, 1)))
> 
> tfun # printing
An epiworld_tool_function object.
(model: Susceptible-Infected-Recovered (SIR))
This function was built using -tool_fun_logit()-. and it features the following coefficients:
  0: -1.00
  1:  1.00 
> 
> 
> set_susceptibility_reduction_fun(
+   tool  = get_tool(sir, 0),
+   model = sir,
+   tfun  = tfun
+ )
> 
> run(sir, ndays = 50, seed = 11)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> hist_1 <- get_hist_total(sir)
> 
> op <- par(mfrow = c(1, 2))
> plot(hist_0)
> abline(v = 30)
> plot(hist_1)
> abline(v = 30)
> par(op)
> 
> 
> 
> 
> graphics::par(get("par.postscript", pos = 'CheckExEnv'))
> cleanEx()
> nameEx("virus")
> ### * virus
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: virus
> ### Title: Virus design
> ### Aliases: virus epiworld_virus set_name_virus get_name_virus add_virus
> ###   virus_set_state rm_virus virus_fun_logit set_prob_infecting
> ###   set_prob_infecting_ptr set_prob_infecting_fun set_prob_recovery
> ###   set_prob_recovery_ptr set_prob_recovery_fun set_prob_death
> ###   set_prob_death_ptr set_prob_death_fun set_incubation
> ###   set_incubation_ptr set_incubation_fun set_distribution_virus
> ###   distribute_virus_randomly distribute_virus_to_set
> ###   distribute_virus_set distribute_virus_to_entities
> 
> ### ** Examples
> 
> mseirconn <- ModelSEIRCONN(
+   name                = "COVID-19",
+   prevalence          = 0.01,
+   n                   = 10000,
+   contact_rate        = 4,
+   incubation_days     = 7,
+   transmission_rate   = 0.5,
+   recovery_rate       = 0.99
+ )
> 
> delta <- virus(
+   "Delta Variant", 0, .5, .2, .01, prevalence = 0.3, as_proportion = TRUE
+ )
> 
> # Adding virus and setting/getting virus name
> add_virus(mseirconn, delta)
> set_name_virus(delta, "COVID-19 Strain")
> get_name_virus(delta)
[1] "COVID-19 Strain"
> 
> run(mseirconn, ndays = 100, seed = 992)
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> mseirconn
________________________________________________________________________________
Susceptible-Exposed-Infected-Removed (SEIR) (connected)
It features 10000 agents, 2 virus(es), and 0 tool(s).
The model has 4 states.
The final distribution is: 3609 Susceptible, 113 Exposed, 11 Infected, and 6267 Recovered.
> 
> rm_virus(mseirconn, 0) # Removing the first virus from the model object
> set_distribution_virus(delta, distribute_virus_randomly(100, as_proportion = FALSE))
> add_virus(mseirconn, delta)
> 
> # Setting parameters for the delta virus manually
> set_prob_infecting(delta, 0.5)
> set_prob_recovery(delta, 0.9)
> set_prob_death(delta, 0.01)
> run(mseirconn, ndays = 100, seed = 992) # Run the model to observe changes
_________________________________________________________________________
Running the model...
||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
> 
> # If the states were (for example):
> # 1: Infected
> # 2: Recovered
> # 3: Dead
> delta2 <- virus(
+   "Delta Variant 2", 0, .5, .2, .01, prevalence = 0, as_proportion = TRUE
+ )
> virus_set_state(delta2, 1, 2, 3)
> # Using the logit function --------------
> sir <- ModelSIR(
+   name = "COVID-19", prevalence = 0.01,
+   transmission_rate = 0.9, recovery = 0.1
+ )
> 
> # Adding a small world population
> agents_smallworld(
+   sir,
+   n = 10000,
+   k = 5,
+   d = FALSE,
+   p = .01
+ )
> 
> run(sir, ndays = 50, seed = 11)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> plot(sir)
> 
> # And adding features
> dat <- cbind(
+   female = sample.int(2, 10000, replace = TRUE) - 1,
+   x      = rnorm(10000)
+ )
> 
> set_agents_data(sir, dat)
> 
> # Creating the logit function
> vfun <- virus_fun_logit(
+   vars  = c(0L, 1L),
+   coefs = c(-1, 1),
+   model = sir
+ )
> 
> # The infection prob is lower
> hist(plogis(dat %*% rbind(-1, 1)))
> 
> vfun # printing
An epiworld_virus_function object.
(model: Susceptible-Infected-Recovered (SIR))
This function was built using -virus_fun_logit()-. and it features the following coefficients:
  0: -1.00
  1:  1.00 
> 
> set_prob_infecting_fun(
+   virus = get_virus(sir, 0),
+   model = sir,
+   vfun  = vfun
+ )
> 
> run(sir, ndays = 50, seed = 11)
_________________________________________________________________________
|Running the model...
|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.
|> plot(sir)
> 
> 
> 
> 
> ### * <FOOTER>
> ###
> cleanEx()
> options(digits = 7L)
> base::cat("Time elapsed: ", proc.time() - base::get("ptime", pos = 'CheckExEnv'),"\n")
Time elapsed:  10.1 0.303 11.198 0.003 0 
> grDevices::dev.off()
null device 
          1 
> ###
> ### Local variables: ***
> ### mode: outline-minor ***
> ### outline-regexp: "\\(> \\)?### [*]+" ***
> ### End: ***
> quit('no')
